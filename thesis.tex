\documentclass[11pt,twoside]{article}
\usepackage{geometry}
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{latexsym,booktabs}
\usepackage{amsmath,amssymb,bbold, xfrac}
\usepackage{graphicx}
\usepackage[singlespacing]{setspace}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{multirow}

\usepackage{caption}

\usepackage{hyperref}
\hypersetup{colorlinks=True, urlcolor=cyan}

\usepackage[backend=bibtex, citestyle=authoryear, bibstyle=alphabetic]{biblatex}
\addbibresource{literature.bib}

\geometry{a4paper,left=2cm,right=2.0cm, top=2cm, bottom=2.0cm}

\newtheorem{Definition}{Definition}
\newtheorem{Theorem}{Theorem}
\newtheorem{Lemma}{Lemma}
\newtheorem{Corollary}{Corollary}
\newtheorem{Proposition}{Proposition}
\newtheorem{Algorithm}{Algorithm}
\numberwithin{Theorem}{section}
\numberwithin{Definition}{section}
\numberwithin{Lemma}{section}
\numberwithin{Algorithm}{section}
\numberwithin{equation}{section}

% Python style code
\usepackage[finalizecache, cachedir=./minted_files]{minted}
\usemintedstyle{tango}
\usepackage{listings}
\usepackage{xcolor}
\newcommand{\pinline}[1]{\mintinline{python}{#1}}
\newminted{python}{framesep=2mm,
baselinestretch=1.2,
fontsize=\small,
frame=single
}



% Define custom commands
\newcommand{\bigO}{\mathcal{O}}
%% Define notation
\newcommand{\X}{\mathbf{x}}
\newcommand{\Z}{\mathbf{z}}
\newcommand{\V}{\mathbf{V}}
\newcommand{\Y}{\mathbf{Y}}
\newcommand{\hess}{\mathbf{H}}
\newcommand{\Thetab}{\mathbf{\Theta}}

\newcommand{\vb}{\mathbf{v}}
\newcommand{\yb}{\mathbf{y}}
\newcommand{\xb}{\mathbf{x}}

\newcommand{\jac}{\mathbf{J}}
\newcommand{\hessian}{\mathbf{H}}
\newcommand{\thetab}{\boldsymbol{\theta}}
\newcommand{\thetabij}{\thetab_{ij}}
\newcommand{\thetabi}{\thetab_i}

\newcommand{\region}{B_{d,\epsilon}}
\newcommand{\indicator}[1]{\mathbb{1}_{#1}}
\newcommand{\regioni}{B_{d,\epsilon}^i}
\newcommand{\data}{\mathbf{y_0}}

\newcommand{\R}{\mathbb{R}}


% \newcommand{\likelihood}{L(\theta)}
% \newcommand{\loglikelihood}{l(\theta)}
% \newcommand{\likelihoodabc}{L_{d, \epsilon}}
% \newcommand{\posterior}{p(\thetab|\Xobs)}
% \newcommand{\posteriorabc}{p_{\epsilon}(\theta|\Xobs)}
% \newcommand{\nuisance}{\mathbf{u}}
% \newcommand{\model}{\gen(\thetab,\nuisance)}
% \newcommand{\xobs}{x^0}
% \newcommand{\Xobs}{\X^0}
% \newcommand{\xsim}{x_i}
% \newcommand{\Xsim}{\X_i}
% \newcommand{\region}{C_\epsilon(\nuisance)}
% \newcommand{\regionpair}{C_\epsilon}

% \newcommand{\regionuni}{U^i_\epsilon(\thetab)}
% \newcommand{\optend}{\thetab^*_i}
% \newcommand{\Doptend}{d^*_i}

% \newcommand{\optendname}{\text{optimisation end point}}   % In-text name for what I call "OMC sample"

% \newcommand{\dete}{|\det (\A_i)|}
% \newcommand{\determ}{\dete^{-1}}

% \newcommand{\parameters}{\theta}
% \newcommand{\gpmodel}{\hat{d}_i}
% \newcommand{\image}{x(\theta, \nuisance)}
% \newcommand{\distance}{d(\image, \xobs)}
% \newcommand{\gradfull}{\frac{\partial \distance}{\partial \parameters}}
% \newcommand{\gradopendr}{\frac{\partial \image}{\partial \parameters}}
% \newcommand{\gradrecog}{\frac{\partial \distance}{\partial \image}}
% \newcommand{\recog}{r(x)}
% \newcommand{\thetau}{\theta_i(u_j)}


% \newcommand{\sumstat}{\Phi}
% \newcommand{\gensum}{\mathbf{f}}
% \newcommand{\sumstatObs}{\mathbf{y}^0}
% \newcommand{\E}{\mathop{\mathbb{E}}}
% \newcommand{\M}{\mathbf{M}}
% \newcommand{\A}{\mathbf{A}}
% \newcommand{\gen}{g}
% \newcommand{\voli}{\text{vol}(\regioni)}
% \newcommand{\vole}{\text{vol}(B_{\epsilon})}
% \newcommand{\w}{\mathbf{w}}
% \newcommand{\hpost}{\bar{h}} % \E[h(\thetab) | \Xobs]
% \newcommand{\ESS}{\textrm{ESS}}

% %% Define transpose symbol
% \newcommand{\tran}{\mkern-2mu\raise1.25ex\hbox{$\scriptscriptstyle\top$}\mkern-3.5mu}
% \newcommand{\tranlow}{\mkern-2mu\raise0.75ex\hbox{$\scriptscriptstyle\top$}\mkern-3.5mu}

% %% for formatting of paragraphs in Section 3 that describe the paragraphs
% \newcommand{\algformat}[1]{\textbf{#1}}
% %\newcommand{\algformat}[1]{\emph{#1}}
% %\newcommand{\algformat}[1]{#1}

\begin{document}

\pagestyle{empty}

% =============================================================================
% Title page
% =============================================================================
\begin{titlepage}
\vspace*{.5em}
\center
\textbf{\large{The School of Mathematics}} \\
\vspace*{1em}
\begin{figure}[!h]
\centering
\includegraphics[width=180pt]{Thesis/images/CentredLogoCMYK.jpg}
\end{figure}
\vspace{2em}
\textbf{\Huge{Extending the statistical software package Engine for Likelihood-Free Inference}}\\[2em]
\textbf{\LARGE{by}}\\
\vspace{2em}
\textbf{\LARGE{Vasileios Gkolemis}}\\
\vspace{6.5em}
\Large{Dissertation Presented for the Degree of\\
MSc in Operational Research with Data Science}\\
\vspace{6.5em}
\Large{August 2020}\\
\vspace{3em}
\Large{Supervised by\\Dr. Michael Gutmann}
\vfill
\end{titlepage}

\cleardoublepage
% =============================================================================
% Abstract, acknowledgments, and own work declaration
% =============================================================================
\begin{center}
\Large{Abstract}
\end{center}

Bayesian inference is a principled framework for dealing with
uncertainty. The practitioner can
perform an initial assumption for the physical phenomenon they want to
model (prior belief), collect some data and then adjust the
initial assumption in the light of the new evidence (posterior
belief).  Approximate Bayesian Computation (ABC) methods, also known
as likelihood-free inference techniques, are a class of models used for
performing inference when the likelihood is intractable. The unique
requirement of these models is a black-box sampling machine. Due to
the modelling-freedom they provide these approaches are particularly
captivating.


Robust Optimisation Monte Carlo (ROMC) is one of the most recent
techniques of the specific domain. It approximates the posterior
distribution by solving independent optimisation problems. This
dissertation focuses on the implementation of the ROMC method in the
software package "Engine for Likelihood-Free Inference" (ELFI). In the
first chapters, we provide the mathematical formulation and the
algorithmic description of the ROMC approach. In the following
chapters, we describe our implementation; (a) we present all the
functionalities provided to the user and (b) we demonstrate how to
perform inference on some real examples.  Our implementation provides 
a robust and efficient solution to a
practitioner who wants to perform inference on a simulator-based
model. Furthermore, it exploits parallel processing for accelerating the inference wherever it is possible. Finally, it has been designed to serve extensibility; the
user can easily replace specific subparts of the method without
significant overhead on the development side. Therefore, it can be
used by a researcher for further experimentation.



\clearpage

\begin{center}
\Large{Acknowledgments}
\end{center}

I would like to thank Michael Gutmann, who was an excellent supervisor
throughout the whole period of the dissertation.  His directions and
insights were fundamental in the completion of this thesis. Despite
the difficulties of remote communication, our collaboration remained
pleasant and constructive.

Above all, a special thank to my family for supporting me all this
season. Without their support, I would not have made it to complete
this program.

\clearpage

\begin{center}
\Large{Own Work Declaration}
\end{center}

\hfill

I declare that this thesis was composed by myself and that
the work contained therein is my own, except where explicitly stated
otherwise in the text.

\hfill

\hfill

Vasileios Gkolemis
\cleardoublepage



% =============================================================================
% Table of contents, tables, and pictures (if applicable)
% =============================================================================
\pagestyle{plain}
\setcounter{page}{1}
\pagenumbering{Roman}

\tableofcontents
\clearpage
\listoftables
\listoffigures
\cleardoublepage

\pagenumbering{arabic}
\setcounter{page}{1}

\nocite{*}
\clearpage


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
\label{sec:introduction}
 This dissertation is mainly focused on the implementation of the
Robust Optimisation Monte Carlo (ROMC) method as it was proposed by
\autocite{Ikonomov2019}, at the Python package ELFI - "Engine For
Likelihood-Free Inference" \autocite{1708.00707}. ROMC is a novel
likelihood-free inference approach for simulator-based models.

\subsection{Motivation}
\label{subsec:motivation}
% \input{ch1/motivation}
\input{Thesis/ch1/motivation}

\subsection{Outline of Thesis}
\label{subsec:outline-of-thesis}
% \input{ch1/outline}
\input{Thesis/ch1/outline}

\subsection{Notation}
\label{subsec:notation}
% \input{ch1/notation}
\input{Thesis/ch1/notation}

\subsection{Online notebooks}
\label{subsec:notebooks}
% \input{ch1/notation}
\input{Thesis/ch1/onlineNotebooks}
\clearpage


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Background}
\label{sec:background}

\subsection{Simulator-based models}
% \input{ch2/simBasedModels}
\input{Thesis/ch2/simBasedModels}

\subsection{Robust Optimisation Monte Carlo (ROMC) approach}
\label{subsec:ROMC}
% \input{ch2/ROMC}
\input{Thesis/ch2/ROMC}

\subsection{Algorithmic description of ROMC}
\label{subsec:romc-algorithmic}
% \input{ch2/ROMC_algorithmic}
\input{Thesis/ch2/ROMC_algorithmic}

\subsection{Engine for Likelihood-Free Inference (ELFI) package}
\label{subsec:elfi}
% \input{ch2/ELFI}
\input{Thesis/ch2/ELFI}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\clearpage
\section{Implementation}
In this section, we will exhibit the implementation of the ROMC
inference method in the ELFI package. The presentation is divided in
two logical blocks; In section~\ref{subsec:user} we present our method from the \emph{user's point-of-view}, i.e.\ what functionalities a practitioner can use for performing the inference in a simulator-based model. For showing the functions in-practice, we set-up a simple running example and
illustrate the functionalities on top of it. In section~\ref{subsec:developers} we delve into the internals of the
code, presenting the details of the implementation. This
section mainly refers to a \emph{researcher or a developer} who
would like to use ROMC as a meta-algorithm and experiment with novel
approaches. We have designed our implementation preserving
extensibility and customisation; hence, a researcher may intervene in
parts of the method without too much effort. A driver example which
demonstrates how to extend the method with custom utilities is
also contained in this section.

\subsection{Implementation description from the user's point-of-view}
\label{subsec:user}
\input{Thesis/ch3/user}

\subsection{Implementation details for the developer}
\label{subsec:developers}
\input{Thesis/ch3/developer}
\clearpage


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Experiments}
This section incorporates two real-case examples for demonstrating the
accuracy of the method both at a conceptual and the implementation
level. The first example has tractable likelihood, therefore the
ground-truth information is available and can be used for
validation. The second example is the second-degree moving average
model, which is a basic example used by the ELFI package for checking
the inference methods. This model is also chosen to illustrate that
our implementation performs well at a general model, not implemented
by us.

\subsection{Example 1: Simple 2D example}
\label{subsec:ex1}
\input{Thesis/ch4/ex1}

\subsection{Example 2: Second-order Moving Average MA(2)}
\label{subsec:ma2}
\input{Thesis/ch4/ma2}

\subsection{Execution Time Experiments}
\label{subsec:exec}
\input{Thesis/ch4/exec}
\clearpage


\section{Conclusion}


This chapter concludes the dissertation. We summarise the main
contributions of our work, both on the theoretical and the
implementation side. Furthermore, based on our observation throughout
the implementation of the ROMC method, we suggest some ideas for
future research!

\subsection{Outcomes}
\label{subsec:outcomes}
\input{Thesis/ch5/outcomes}

\subsection{Future Research Directions}
\label{subsec:future}
\input{Thesis/ch5/future}
\clearpage

\printbibliography
\clearpage

% \appendix
% \section*{Appendices}
% \addcontentsline{toc}{section}{Appendices}

% \clearpage
% \section{An Appendix}
% \label{app:one}

% \clearpage

% \section{Another Appendix}
% \label{app:two}

\end{document}
